## Адмін панель

Що ж, для реалізації адмін панелі можна використовувати зручний інтерфейс, написаний на React.js, який буде надсилати відповідні запити на бекенд. Але для самої реалізації поняття "Адмін" потрібно створити систему ролей, яка буде розділяти звичайних користувачів, від адміністраторів та інших. Або ж передбачити, що на сайті можуть бути тільки адміністратори, проте це досить специфічний розділ задач, який трапляється не надто часто. 

Розглядаючи варіант додатку із звичайними користувачами і адміністраторами. Для перевірки у експресі є дуже зручна система роутингу, де можна застосовувати middleware, які будуть звіряти роль і тому подібне. Наприклад є розділ, певна система ендпоінтів, до яких звичайний користувач не повинен мати доступу, то у такій ситуації ми використовуємо перевірку на початку цих шляхів.Також можна використовувати додаткові пакети по типу Passport.js, який є як у Express.js так і в Nest.js. За його допомогою можна визначити загальну стратегію авторизації. На власній практиці я використовував метод з використанням замикання (як в Express.js, так і на Nest.js, проте у другому я використовував структуру декораторів). Ми прямо перед ендпоінтом (або роутером) задаємо роль, або ж ролі, які можуть мати доступ до нього, ось приклад:

```js
function checkRole(role) {
  return function(req, res, next) {
    if (/*Перевірка авторизованості*/ && req.user.role === role) {
      return next();
    }
    res.redirect('/login');
  };
}

app.get('/admin', checkRole('admin'), function(req, res) {
  //Повернення даних
});
```
**Плючи**: зрозуміла абстракція, яку можна легко та швидко ввести у використання. Цей метод є розповсюдженим, багато прикладів коду і вирішення проблем.

**Мінуси**: в деякій літературі кажуть, що використання middleware- погана практика, адже такий підхід заберає певну кількість логіки з контролеру, збільшує кількість абстракції, більше підв'яюзеє код серверу на фреймворк, тобто він стає залежним від нього, може бути спрацювання неправильного контексту і сервер буде видивати помилки і постійно перезавантажуватися і, у разі неправильного спрацювання, залишає контролер повністю беззахисним перед шахраями, тому тут є вибір у підходах до вирішення проблеми.

## Робота з медіафайлами

Для роботи з медіафайлами на практиці я використовував Multer, який дозволяє зручно зберігати медіафайли у файловій системі самої АPI, або десь у іншому місці на ПК чи сервері, а у базу даних передавати шлях до цього файлу. Також, якщо нам потрібно обробляти відео та документи, нам може знадобитися file-type для визначення типів, правильно розподілення і перевірки, а також sharp, якщо треба змінювати формати фотографій.

```js
const express = require('express');
const multer = require('multer');
const sharp = require('sharp');
const path = require('path');

const app = express();
const port = 3000;

const storage = multer.memoryStorage();
const upload = multer({ storage: storage });

app.get('/', (req, res) => {
  res.sendFile(path.join(__dirname, 'index.html'));
});

app.post('/upload', upload.single('image'), async (req, res) => {
  try {
    const ImageBuffer = await sharp(req.file.buffer)
      .resize(350, 350) 
      .toFormat('png')
      .toBuffer();

      sharp(ImageBuffer).toFile('output.png', (err) => {
        if (err) throw err;
        console.log('Processed image saved!');
    });

    res.type('png').send(ImageBuffer);
  } catch (err) {
    console.error(err);
    res.status(500).send('Internal Server Error');
  }
});

app.listen(port, () => {
  console.log(`Server is running at http://localhost:${port}`);
});
```

Це дуже базовий приклад налаштування такої логіки серверу.

**Плюси**: Це непоганий підхід, адже він розвантажує БД, через що передача даних буде проходити швидше

**Мінуси**: Збереження великої кількості файлів на сервері може перенавантажити сховище. Якщо Ви хочете мати "Самостійну БД", яка не буде залежити від пристрою, на якому вона запущена, то можна зберігати напряму. У своїй практиці я взаємодіяв лише з картинками, які було зручно кодувати у base64 формат, який зручно зберігався і декодувався назад. Для оптимізації можна обмежити розмір картинок, які користувач може встановлювати.

## Додаткові пакети

Із додаткових пакетів я б встановив dotenv, адже це гарна практика, коли важливі, "секретні" значення винесені в окремий файл навколишнього середовища. Я б встановив би Swagger, адже знаю, що документація до API сильно полегшує розробку для інших відділів, як, наприклад, фронтенд, тестери. Також, якщо ми використовуємо Multer, то можна встановити express-static, який відкриває доступ до папки з файлами. Body-parser, Cookie-parser, express-validator, cors- всі вони можуть знадобитися у Вашому проекті, все залежить від Ваших вимог до нього.

### Час фактично затрачений на виконання першого завдання "Я у мами ресечер"

Це, приблизно 1 година 20 хвилин, з якої:
* 20 хвилин- уточнення інформації
* 1 година- написання, оформлення, придумування прикладів коду, виправлення помилок у тексті



* Для знаходження підстав для критикування middleware я використовував лекції мого вчителя Тимура Гафаровича Шемседінова, це дуже цікавий матеріал, який можна подивитися за посиланням: [тут](https://www.youtube.com/watch?v=RS8x73z4csI&ab_channel=fwdays) *